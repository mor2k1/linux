resources:
  - name: yuval-repo
    type: GitRepo
    configuration:
      gitProvider: yuvalGithub
      path: mor2k1/linux
      branches:
        include: IntelliJ

  - name: docker-file
    type: Image
    configuration:
      registry: yuvalArtifactory
      sourceRepository: main-repohubvirt
      imageName: avigdor.jfrog.io/main-repohubvirt/ubuntu
      imageTag: latest
      autoPull: true

  - name: docker-build
    type: BuildInfo
    configuration:
      sourceArtifactory: yuvalArtifactory
      buildName: docker-build-yuval
      buildNumber: ${run_number}

pipelines:
  - name: yuval_pipeline_build_docker
    steps:
      - name: docker_build
        type: DockerBuild
        configuration:
          affinityGroup: yuval_docker
          dockerFileName: Dockerfile
          dockerImageName: avigdor.jfrog.io/main-repohubvirt/ubuntu
          dockerImageTag: latest
          inputResources:
            - name: yuval-repo
            - name: docker-file
          integrations:
            - name: yuvalArtifactory
